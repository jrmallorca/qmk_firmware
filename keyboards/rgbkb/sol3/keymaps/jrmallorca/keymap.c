#include QMK_KEYBOARD_H

#include "keymap_steno.h"
#include "oneshot.h"

// Define layers
#define LA_DEF  DF(DEFAULT)
#define LA_SYM  MO(SYM)
#define LA_NAV  MO(NAV)
#define LA_MNAV MO(MOUSE_NAV)
#define LA_NUM  MO(NUM)
#define LA_GAME DF(GAME)
#define LA_GKR  DF(GAME_KK_RPG)
#define LA_GNUM MO(GAME_NUM)
#define LA_STNO DF(STENO)

// Define keys
#define O_LSFT OSM(MOD_LSFT)

#define S_LBRC S(KC_LBRC)
#define S_RBRC S(KC_RBRC)
#define S_LABK S(KC_COMM)
#define S_RABK S(KC_DOT)

#define K_QSTN S(KC_SLSH)
#define K_PIPE S(KC_NUBS)
#define K_USCR S(KC_MINS)
#define K_AT   S(KC_QUOT)
#define K_PLUS S(KC_EQL)
#define K_CLN  S(KC_SCLN)
#define K_TLDE S(KC_NUHS)

#define K_HOME G(KC_LEFT)
#define K_END  G(KC_RGHT)
#define K_TABL G(S(KC_LBRC))
#define K_TABR G(S(KC_RBRC))
#define K_SPCL A(G(KC_LEFT))
#define K_SPCR A(G(KC_RGHT))

enum sol_layers {
    DEFAULT,
    SYM,
    NAV,
    MOUSE_NAV,
    NUM,
    GAME,
    GAME_KK_RPG,
    GAME_NUM,
    STENO,
};

enum sol_keycodes {
    // Disables touch processing
    TCH_TOG = SAFE_RANGE,
    MENU_BTN,
    MENU_UP,
    MENU_DN,
    RGB_RST,

    // Custom oneshot mod implementation with no timers.
    OS_SHFT,
    OS_CTRL,
    OS_ALT,
    OS_CMD,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

/* Default (COLEMAK-DH)
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │RGB_TG│ HUE- │ SAT- │EFFCT-│MODE- │BRIGT-│Reset │  │Reset │BRIGT+│MODE+ │EFFCT+│ SAT+ │ HUE+ │RGB_RT│
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │   W  │   F  │   P  │   B  │Power │  │L_GKR │   J  │   L  │   U  │   Y  │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │ Tab  │   Q  │   R  │   S  │   T  │   G  │ Wake │  │L_DEF │   M  │   N  │   E  │   I  │   '  │Delete│
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │Escape│   A  │   X  │   C  │   D  │   V  │Sleep │  │L_STNO│   K  │   H  │   ,  │   .  │   O  │ BSPC │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │   Z  │      │      │      │      │L_NAV │  │L_SYM │      │      │L_GAME│      │   ?  │      │
 * └──────┴──────┴──────┴──────┴──────┤Space ├──────┤  ├──────┤Enter ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │OSHIFT│  │CAPWRD│      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [DEFAULT] = LAYOUT(
        RGB_TOG, RGB_HUD, RGB_SAD, RGB_SPD, RGB_RMOD,RGB_VAD, QK_BOOT,                   QK_BOOT, RGB_VAI, RGB_MOD, RGB_SPI, RGB_SAI, RGB_HUI, RGB_RST,
        _______, _______, KC_W   , KC_F   , KC_P   , KC_B   , KC_PWR ,                   LA_GKR , KC_J   , KC_L   , KC_U   , KC_Y   , _______, _______,
        KC_TAB , KC_Q   , KC_R   , KC_S   , KC_T   , KC_G   , KC_WAKE,                   LA_DEF , KC_M   , KC_N   , KC_E   , KC_I   , KC_QUOT, KC_DEL ,
        KC_ESC , KC_A   , KC_X   , KC_C   , KC_D   , KC_V   , KC_SLEP,                   LA_STNO, KC_K   , KC_H   , KC_COMM, KC_DOT , KC_O   , KC_BSPC,
        _______, KC_Z   , _______, _______, _______, KC_SPC , LA_NAV , O_LSFT , CAPSWRD, LA_SYM , KC_ENT , _______, LA_GAME, _______, K_QSTN , _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* SYM
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │   "  │   £  │   $  │   +  │      │  │      │   =  │   %  │   ^  │   &  │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │   !  │   _  │   -  │   ;  │   #  │      │  │      │   ~  │ CTRL │ SHFT │ ALT  │   *  │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │   /  │   :  │   [  │   (  │   {  │   |  │      │  │      │   `  │   }  │   )  │   ]  │ CMD  │  \   │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │   @  │   <  │      │      │      │      │      │  │      │      │      │      │      │   >  │      │
 * └──────┴──────┴──────┴──────┴──────┤      ├──────┤  ├──────┤      ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │      │  │      │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [SYM] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, _______, _______,
        _______, _______, S(KC_2), S(KC_3), S(KC_4), K_PLUS , _______,                   _______, KC_EQL , S(KC_5), S(KC_6), S(KC_7), _______, _______,
        _______, S(KC_1), K_USCR , KC_MINS, KC_SCLN, KC_NUHS, _______,                   _______, K_TLDE , OS_CTRL, OS_SHFT, OS_ALT , S(KC_8), _______,
        KC_SLSH, K_CLN  , KC_LBRC, S(KC_9), S_LBRC , K_PIPE , _______,                   _______, KC_GRV , S_RBRC , S(KC_0), KC_RBRC, OS_CMD , KC_NUBS,
        K_AT   , S_LABK , _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, S_RABK , _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* NAV
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │      │      │      │      │      │  │      │      │ HOME │  UP  │ END  │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │ ALT  │ SHFT │ CTRL │      │      │  │      │      │ LEFT │ DOWN │RIGHT │ PGUP │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │ CMD  │ SPCL │ SPCR │ TABR │      │      │  │      │      │      │      │      │ PGDN │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │ TABL │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┤      ├──────┤  ├──────┤      ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │L_MNAV│  │      │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [NAV] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, K_HOME , KC_UP  , K_END  , _______, _______,
        _______, _______, OS_ALT , OS_SHFT, OS_CTRL, _______, _______,                   _______, _______, KC_LEFT, KC_DOWN, KC_RGHT, KC_PGUP, _______,
        _______, OS_CMD , K_SPCL , K_SPCR , K_TABR , _______, _______,                   _______, _______, _______, _______, _______, KC_PGDN, _______,
        _______, K_TABL , _______, _______, _______, _______, _______, LA_MNAV, _______, _______, _______, _______, _______, _______, _______, _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* MOUSE_NAV
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │MOUS_3│      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │      │      │      │      │      │  │      │      │MOUS_1│MOUS_U│MOUS_2│      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │ ALT  │ SHFT │ CTRL │      │      │  │      │      │MOUS_L│MOUS_D│MOUS_R│SCRL_U│      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │ CMD  │      │      │      │      │      │  │      │      │SCRL_L│      │SCRL_R│SCRL_D│      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┤      ├──────┤  ├──────┤      ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │      │  │      │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [MOUSE_NAV] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, KC_BTN3, _______, _______, _______,
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, KC_BTN1, KC_MS_U, KC_BTN2, _______, _______,
        _______, _______, OS_ALT , OS_SHFT, OS_CTRL, _______, _______,                   _______, _______, KC_MS_L, KC_MS_D, KC_MS_R, KC_WH_U, _______,
        _______, OS_CMD , _______, _______, _______, _______, _______,                   _______, _______, KC_WH_L, _______, KC_WH_R, KC_WH_D, _______,
        _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* NUM
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │  2   │  3   │  4   │  5   │      │  │      │  6   │  7   │  8   │  9   │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │  1   │ ALT  │ SHFT │ CTRL │ F11  │      │  │      │ F12  │ CTRL │ SHFT │ ALT  │  0   │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │ CMD  │  F2  │  F3  │  F4  │  F5  │      │  │      │  F6  │  F7  │  F8  │  F9  │ CMD  │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │  F1  │      │      │      │      │      │  │      │      │      │      │      │ F10  │      │
 * └──────┴──────┴──────┴──────┴──────┤      ├──────┤  ├──────┤      ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │      │  │      │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [NUM] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, _______, _______,
        _______, _______, KC_2   , KC_3   , KC_4   , KC_5   , _______,                   _______, KC_6   , KC_7   , KC_8   , KC_9   , _______, _______,
        _______, KC_1   , OS_ALT , OS_SHFT, OS_CTRL, KC_F11 , _______,                   _______, KC_F12 , OS_CTRL, OS_SHFT, OS_ALT , KC_0   , _______,
        _______, OS_CMD , KC_F2  , KC_F3  , KC_F4  , KC_F5  , _______,                   _______, KC_F6  , KC_F7  , KC_F8  , KC_F9  , OS_CMD , _______,
        _______, KC_F1  , _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, KC_F10 , _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* Game (Keyboard + Mouse) (QWERTY)
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │   W  │   E  │   R  │   T  │      │  │      │   Y  │   U  │   I  │   O  │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │ Tab  │   Q  │   S  │   D  │   F  │   G  │      │  │      │   H  │   J  │   K  │   L  │   P  │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │ SHFT │   A  │   X  │   C  │   V  │   B  │      │  │      │   N  │   M  │   ,  │   .  │   ;  │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │Escape│   Z  │      │      │L_GNUM│      │ CTRL │  │      │      │      │      │      │   /  │      │
 * └──────┴──────┴──────┴──────┴──────┤Space ├──────┤  ├──────┤      ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │ ALT  │  │      │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [GAME] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, _______, _______,
        _______, _______, KC_W   , KC_E   , KC_R   , KC_T   , _______,                   _______, KC_Y   , KC_U   , KC_I   , KC_O   , _______, _______,
        KC_TAB , KC_Q   , KC_S   , KC_D   , KC_F   , KC_G   , _______,                   _______, KC_H   , KC_J   , KC_K   , KC_L   , KC_P   , _______,
        KC_LSFT, KC_A   , KC_X   , KC_C   , KC_V   , KC_B   , _______,                   _______, KC_N   , KC_M   , KC_COMM, KC_DOT , KC_SCLN, _______,
        KC_ESC , KC_Z   , _______, _______, LA_GNUM, KC_SPC , KC_LCTL, KC_LALT, _______, _______, _______, _______, _______, _______, KC_SLSH, _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* Game (Keyboard only) (QWERTY) (RPG)
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │MOUS_3│      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │   W  │   E  │   R  │   T  │      │  │      │   Y  │MOUS_1│MOUS_U│MOUS_2│      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │   Q  │   S  │   D  │   F  │   G  │      │  │      │   H  │MOUS_L│MOUS_D│MOUS_R│SCRL_U│      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────├──────│
 * │Escape│   A  │   X  │   C  │   V  │   B  │      │  │      │   N  │   M  │   ,  │   .  │SCRL_D│Enter │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────├──────│
 * │      │   Z  │      │      │      │      │ CTRL │  │ ALT  │      │      │      │      │   /  │      │
 * └──────┴──────┴──────┴──────┴──────┤Space ├──────┤  ├──────┤ SHFT ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │ Tab  │  │L_GNUM│      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [GAME_KK_RPG] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, KC_BTN3, _______, _______, _______,
        _______, _______, KC_W   , KC_E   , KC_R   , KC_T   , _______,                   _______, KC_Y   , KC_BTN1, KC_MS_U, KC_BTN2, _______, _______,
        _______, KC_Q   , KC_S   , KC_D   , KC_F   , KC_G   , _______,                   _______, KC_H   , KC_MS_L, KC_MS_D, KC_MS_R, KC_WH_U, _______,
        KC_ESC , KC_A   , KC_X   , KC_C   , KC_V   , KC_B   , _______,                   _______, KC_N   , KC_M   , KC_COMM, KC_DOT , KC_WH_D, KC_ENT ,
        _______, KC_Z   , _______, _______, _______, KC_SPC , KC_LCTL, KC_TAB , LA_GNUM, KC_LALT, KC_LSFT, _______, _______, _______, KC_SLSH, _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* Game numbers
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │      │   3  │      │      │      │  │      │      │      │   8  │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │   2  │      │   4  │   5  │      │  │      │   6  │   7  │      │   9  │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │   1  │      │      │      │      │      │  │      │      │      │      │      │   0  │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┤      ├──────┤  ├──────┤      ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │      │  │      │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [GAME_NUM] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, _______, _______,
        _______, _______, _______, KC_3   , _______, _______, _______,                   _______, _______, _______, KC_8   , _______, _______, _______,
        _______, _______, KC_2   , _______, KC_4   , KC_5   , _______,                   _______, KC_6   , KC_7   , _______, KC_9   , _______, _______,
        _______, KC_1   , _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, KC_0   , _______,
        _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______, _______,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),

/* Stenography
 * ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐  ┌──────┬──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │      │  │      │      │      │      │      │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │      │   #  │   #  │   #  │   #  │      │  │      │   #  │   #  │   #  │   #  │      │      │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤
 * │      │   #  │   T  │   P  │   H  │   *  │      │  │      │   *  │   F  │   P  │   L  │   #  │   #  │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────├──────│
 * │      │   S  │   K  │   W  │   R  │   *  │      │  │      │   *  │   R  │   B  │   G  │   T  │   D  │
 * ├──────┼──────┼──────┼──────┼──────┼──────┼──────┤  ├──────┼──────┼──────┼──────┼──────┼──────├──────│
 * │      │   S  │      │      │      │      │      │  │      │      │      │      │      │   S  │   Z  │
 * └──────┴──────┴──────┴──────┴──────┤   A  ├──────┤  ├──────┤   U  ├──────┴──────┴──────┴──────┴──────┘
 *                                    │      │   O  │  │   E  │      │
 *                                    └──────┴──────┘  └──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┬──────┐                ┌──────┬──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │      │                │      │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┴──────┘                └──────┴──────┴──────┴──────┴──────┴──────┘
 * ┌──────┬──────┬──────┬──────┬──────┐                              ┌──────┬──────┬──────┬──────┬──────┐
 * │      │      │      │      │      │                              │      │      │      │      │      │
 * └──────┴──────┴──────┴──────┴──────┘                              └──────┴──────┴──────┴──────┴──────┘
 */

    [STENO] = LAYOUT(
        _______, _______, _______, _______, _______, _______, _______,                   _______, _______, _______, _______, _______, _______, _______,
        _______, _______, STN_N2 , STN_N3 , STN_N4 , STN_N5 , _______,                   _______, STN_N6 , STN_N7 , STN_N8 , STN_N9 , _______, _______,
        _______, STN_N1 , STN_TL , STN_PL , STN_HL , STN_ST1, _______,                   _______, STN_ST3, STN_FR , STN_PR , STN_LR , STN_NA , STN_NB ,
        _______, STN_S1 , STN_KL , STN_WL , STN_RL , STN_ST2, _______,                   _______, STN_ST4, STN_RR , STN_BR , STN_GR , STN_TR , STN_DR ,
        _______, STN_S2 , _______, _______, _______, STN_A  , _______, STN_O  , STN_E  , _______, STN_U  , _______, _______, _______, STN_SR , STN_ZR ,

        _______, _______, _______, _______, _______, _______,                                     _______, _______, _______, _______, _______, _______,
        _______, _______, _______, _______, _______,                                                       _______, _______, _______, _______, _______
    ),
};

bool is_oneshot_cancel_key(uint16_t keycode) {
    switch (keycode) {
    case LA_SYM:
    case LA_NAV:
        return true;
    default:
        return false;
    }
}

bool is_oneshot_ignored_key(uint16_t keycode) {
    switch (keycode) {
    case LA_SYM:
    case LA_NAV:
    case KC_LSFT:
    case OS_SHFT:
    case OS_CTRL:
    case OS_ALT:
    case OS_CMD:
        return true;
    default:
        return false;
    }
}

oneshot_state os_shft_state = os_up_unqueued;
oneshot_state os_ctrl_state = os_up_unqueued;
oneshot_state os_alt_state = os_up_unqueued;
oneshot_state os_cmd_state = os_up_unqueued;

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    switch (keycode)
    {
        case MENU_BTN:
            if (record->event.pressed) {
                rgb_menu_selection();
            }
            return false;
        case MENU_UP:
            if (record->event.pressed) {
                rgb_menu_action(true);
            }
            return false;
        case MENU_DN:
            if (record->event.pressed) {
                rgb_menu_action(false);
            }
            return false;
        case RGB_RST:
            if (record->event.pressed) {
                eeconfig_update_rgb_matrix_default();
            }
            return false;
        case TCH_TOG:
            if (record->event.pressed) {
                touch_encoder_toggle();
            }
            return false;  // Skip all further processing of this key
        default:
            update_oneshot(
                &os_shft_state, KC_LSFT, OS_SHFT,
                keycode, record
            );
            update_oneshot(
                &os_ctrl_state, KC_LCTL, OS_CTRL,
                keycode, record
            );
            update_oneshot(
                &os_alt_state, KC_LALT, OS_ALT,
                keycode, record
            );
            update_oneshot(
                &os_cmd_state, KC_LCMD, OS_CMD,
                keycode, record
            );
            return true;
    }
}

layer_state_t layer_state_set_user(layer_state_t state) {
    return update_tri_layer_state(state, SYM, NAV, NUM);
}

void render_layer_status(void) {
    // Host Keyboard Layer Status
    oled_write_P(PSTR("Layer"), false);
    switch (get_highest_layer(layer_state)) {
        case DEFAULT:
            oled_write_ln_P(PSTR("Default"), false);
            break;
        case SYM:
            oled_write_ln_P(PSTR("Symbols"), false);
            break;
        case NAV:
            oled_write_ln_P(PSTR("Navigation"), false);
            break;
        case MOUSE_NAV:
            oled_write_ln_P(PSTR("Mouse Navigation"), false);
            break;
        case NUM:
            oled_write_ln_P(PSTR("Numbers"), false);
            break;
        case GAME:
            oled_write_ln_P(PSTR("Game"), false);
            break;
        case GAME_KK_RPG:
            oled_write_ln_P(PSTR("Game (Keyboard only) (RPG)"), false);
            break;
        case GAME_NUM:
            oled_write_ln_P(PSTR("Game Numbers"), false);
            break;
        case STENO:
            oled_write_ln_P(PSTR("Stenography"), false);
            break;
        default:
            oled_write_ln_P(PSTR("Undef"), false);
    }
}

// Runs just one time when the keyboard initializes.
void matrix_init_user(void) {
    steno_set_mode(STENO_MODE_GEMINI);
};
